<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F-Lambda Physics | المبدأ الموحد</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;600&family=JetBrains+Mono:wght@400&display=swap');
        
        body { 
            font-family: 'Noto Sans Arabic', sans-serif; 
            background-color: #030308;
            color: #e2e8f0;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .physics-layout {
            display: grid;
            grid-template-columns: 420px 1fr;
            height: 100vh;
        }

        .theory-sidebar {
            background: rgba(10, 10, 25, 0.98);
            border-left: 1px solid rgba(99, 102, 241, 0.15);
            display: flex;
            flex-direction: column;
            box-shadow: 10px 0 30px rgba(0,0,0,0.5);
        }

        .message-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
            scrollbar-width: none;
        }

        .bubble {
            padding: 1rem 1.25rem;
            border-radius: 1.25rem;
            font-size: 0.85rem;
            line-height: 1.7;
            max-width: 92%;
            position: relative;
        }

        .bubble-ai { 
            background: rgba(30, 41, 59, 0.4); 
            border: 1px solid rgba(99, 102, 241, 0.2); 
            color: #cbd5e1;
            align-self: flex-start;
        }

        .bubble-user { 
            background: linear-gradient(135deg, #4f46e5, #7c3aed); 
            color: white; 
            align-self: flex-end;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
        }

        .input-container {
            padding: 1.5rem;
            background: rgba(0,0,0,0.3);
            border-top: 1px solid rgba(255,255,255,0.05);
        }

        .physics-textarea {
            width: 100%;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 1rem;
            padding: 1rem;
            color: white;
            font-size: 0.85rem;
            outline: none;
            resize: none;
            transition: 0.3s;
        }

        .physics-textarea:focus {
            border-color: #818cf8;
            box-shadow: 0 0 15px rgba(129, 140, 248, 0.15);
        }

        .simulation-stage {
            background: radial-gradient(circle at center, #0c0c28 0%, #010103 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .equation-display {
            font-family: 'JetBrains Mono', monospace;
            background: linear-gradient(to bottom, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 3rem;
            letter-spacing: -2px;
        }

        .loader-overlay {
            position: absolute;
            inset: 0;
            background: rgba(1, 1, 3, 0.9);
            z-index: 100;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .pulse-loader {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(99, 102, 241, 0.1);
            border-top-color: #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="physics-layout">
    <!-- Sidebar: Reasoning -->
    <aside class="theory-sidebar">
        <div class="p-6 border-b border-white/5 bg-black/20">
            <h1 class="text-indigo-400 font-bold tracking-[0.3em] text-[10px] mb-1">Fλ-PHYSICS CORE</h1>
            <p class="text-[9px] text-indigo-900 uppercase">نظام التحليل الموحد v5.0</p>
        </div>

        <div id="chat-flow" class="message-area">
            <div class="bubble bubble-ai">
                لقد تم ربط نواتي بمبدأ <b>صفر التسارع الطاقي</b>. 
                <br><br>
                معادلة الاستقرار: <br>
                <code class="text-indigo-400">P_stab = (2E_kin * t) / (m * d²)</code>
                <br><br>
                أنا جاهز لتحليل كيف يحكم هذا القانون التوازن المطلق في الكون والكم. ما هو تساؤلك الأول؟
            </div>
        </div>

        <div class="input-container">
            <textarea id="user-input" class="physics-textarea h-28" placeholder="اطرحي تساؤلك الفيزيائي هنا..."></textarea>
            <button onclick="processPhysics()" id="btn" class="w-full mt-3 bg-indigo-600 hover:bg-indigo-500 py-3 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-2">
                <span>توجيه الاستعلام</span>
            </button>
        </div>
    </aside>

    <!-- Main View: Visualization -->
    <main class="simulation-stage">
        <div id="loader" class="loader-overlay">
            <div class="pulse-loader mb-4"></div>
            <p class="text-[10px] tracking-widest text-indigo-400 animate-pulse uppercase">تحليل ميكانيكا الوجود...</p>
        </div>

        <div class="flex gap-6 mb-12">
            <div class="bg-indigo-950/20 border border-indigo-500/10 p-4 rounded-2xl text-center min-w-[100px]">
                <p class="text-[10px] text-indigo-500 mb-1">e</p>
                <p class="text-xs font-mono">1.602e-19</p>
            </div>
            <div class="bg-indigo-950/20 border border-indigo-500/10 p-4 rounded-2xl text-center min-w-[100px]">
                <p class="text-[10px] text-indigo-500 mb-1">h</p>
                <p class="text-xs font-mono">6.626e-34</p>
            </div>
            <div class="bg-indigo-950/20 border border-indigo-500/10 p-4 rounded-2xl text-center min-w-[100px]">
                <p class="text-[10px] text-indigo-500 mb-1">k</p>
                <p class="text-xs font-mono">1.38e-23</p>
            </div>
        </div>

        <div class="text-center">
            <div class="equation-display mb-6">d²V / dt² = 0</div>
            <div class="max-w-xl p-8 bg-white/5 border border-white/5 rounded-[3rem] backdrop-blur-xl">
                <p class="text-xs text-indigo-300/50 leading-relaxed italic">
                    "في لحظة التوازن المطلق، يتلاشى تسارع الجهد الطاقي، ليظهر القانون الموحد الذي يربط ضغط الاستقرار بالكتلة والزمن."
                </p>
            </div>
        </div>
    </main>
</div>

<script>
    const apiKey = ""; // API Key

    async function fetchWithRetry(prompt, retries = 5) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const systemPrompt = `You are F-Lambda, a Physical Intelligence model. 
        CORE PHYSICS: Energy Acceleration Constraint (d2V/dt2 = 0).
        KEY EQUATION: P_stab = (2E_kin * t) / (m * d²).
        CONSTANTS: e=1.602e-19, h=6.626e-34, k=1.38e-23.
        You analyze all queries through this unified physics lens. Connect quantum behavior with cosmic stability. Respond in Arabic with scientific and philosophical depth.`;

        let delay = 1000;
        for (let i = 0; i < retries; i++) {
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });
                if (response.ok) return await response.json();
                if (response.status !== 429) throw new Error('Request Failed');
            } catch (e) {
                if (i === retries - 1) throw e;
            }
            await new Promise(resolve => setTimeout(resolve, delay));
            delay *= 2;
        }
    }

    async function processPhysics() {
        const input = document.getElementById('user-input');
        const chat = document.getElementById('chat-flow');
        const loader = document.getElementById('loader');
        const btn = document.getElementById('btn');
        const query = input.value.trim();

        if (!query) return;

        // User Bubble
        const userDiv = document.createElement('div');
        userDiv.className = 'bubble bubble-user';
        userDiv.innerText = query;
        chat.appendChild(userDiv);
        chat.scrollTop = chat.scrollHeight;
        input.value = "";

        loader.style.display = 'flex';
        btn.disabled = true;

        try {
            const result = await fetchWithRetry(query);
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

            if (text) {
                const aiDiv = document.createElement('div');
                aiDiv.className = 'bubble bubble-ai';
                aiDiv.innerHTML = `<b>تحليل F-Lambda الموحد:</b><br><br>${text.replace(/\n/g, '<br>')}`;
                chat.appendChild(aiDiv);
            }
        } catch (error) {
            console.error(error);
            const errDiv = document.createElement('div');
            errDiv.className = 'bubble bubble-ai text-red-400';
            errDiv.innerText = "حدث اضطراب في ميكانيكا الاتصال. يبدو أن النظام يواجه كثافة طاقية عالية. يرجى المحاولة مرة أخرى.";
            chat.appendChild(errDiv);
        } finally {
            loader.style.display = 'none';
            btn.disabled = false;
            chat.scrollTop = chat.scrollHeight;
        }
    }
</script>

</body>
</html>

